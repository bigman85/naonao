# 企业级管理后台系统 - 第一阶段详细需求文档

## 文档信息
- **版本**: v0.1
- **阶段**: 第一阶段（用户、角色与权限核心模块）
- **周期**: 5周
- **创建日期**: 2023-11-15

## 一、阶段目标
实现基础用户认证、角色管理与权限控制功能，构建完整RBAC权限模型，满足系统安全访问需求。

## 二、功能需求

### 2.1 用户管理模块
#### 2.1.1 用户认证
- 支持用户名/邮箱/手机号登录
- 实现JWT令牌认证机制
- 支持记住登录状态（token有效期配置）
- 提供注销功能
- 实现登录失败处理（错误提示、重试限制）

#### 2.1.2 用户信息管理
- 用户基本信息CRUD操作（姓名、联系方式、邮箱等）
- 支持用户头像上传与显示
- 实现密码重置功能（邮件/短信验证）
- 用户状态管理（启用/禁用）
- 支持用户信息导出（Excel格式）

### 2.2 角色管理基础
#### 2.2.1 角色操作
- 角色创建、查询、编辑、删除功能
- 预设基础角色模板：
  - 超级管理员（所有权限）
  - 系统管理员（系统配置权限）
  - 普通用户（基础操作权限）
- 角色信息管理（名称、描述、状态）

#### 2.2.2 用户-角色关联
- 支持为用户分配多个角色
- 支持批量用户角色分配
- 查看用户已分配角色
- 移除用户角色关联

### 2.3 权限管理基础
#### 2.3.1 权限模型
- 实现RBAC3权限模型
- 支持功能权限（菜单、按钮、接口）
- 权限粒度到操作级别

#### 2.3.2 权限分配
- 角色-权限多对多分配
- 支持批量权限分配
- 权限继承机制实现
- 权限冲突处理策略

#### 2.3.3 权限验证
- 基于URL的权限控制
- 基于按钮元素的权限控制
- API接口权限验证
- 权限缓存机制

### 2.4 基础安全控制
#### 2.4.1 密码安全
- 密码复杂度策略（长度≥8位，包含大小写字母、数字和特殊字符）
- 密码加密存储（使用ASP.NET Core Identity加密机制）
- 密码定期更换提醒
- 历史密码校验（防止重复使用最近5次密码）

#### 2.4.2 访问控制
- 登录IP白名单配置
- 登录失败次数限制（5次失败后锁定30分钟）
- 会话超时控制
- 敏感操作二次验证

#### 2.4.3 操作日志
- 记录用户关键操作（登录、权限变更、重要数据修改）
- 日志内容包括：操作用户、操作时间、IP地址、操作内容、操作结果
- 支持日志查询与导出

## 三、非功能需求

### 3.1 性能要求
- 接口响应时间：≤300ms
- 系统并发用户数：支持50人同时在线
- 数据查询响应：≤500ms

### 3.2 安全要求
- 符合OWASP Top 10安全标准
- 敏感数据传输加密（HTTPS）
- 防SQL注入、XSS攻击
- 接口访问频率限制

### 3.3 可用性要求
- 系统可用性：≥99.9%
- 操作成功率：≥99.5%
- 错误提示明确，引导用户正确操作

## 四、技术要求

### 4.1 技术栈
- **后端**：Asp.Net Core 8.0
- **数据库**：PostgreSQL 16
- **ORM框架**：Entity Framework Core 8.0
- **认证授权**：ASP.NET Core Identity + JWT
- **前端**：React 18 + TypeScript + Ant Design
- **状态管理**：Redux Toolkit
- **API文档**：Swashbuckle.AspNetCore (OpenAPI 3.0)

### 4.2 接口规范
- 遵循RESTful API设计规范
- 统一响应格式：
  ```json
  {
    "code": 200,
    "message": "success",
    "data": {}
  }
  ```
- HTTP状态码正确使用
- 错误信息标准化

## 五、交付成果
1. **功能交付**
   - 用户管理模块（后端API + 前端界面）
   - 角色管理模块（后端API + 前端界面）
   - 权限管理模块（后端API + 前端界面）
   - 安全控制功能（含操作日志）

2. **文档交付**
   - 接口文档（Swagger UI）
   - 数据库设计文档
   - 部署指南
   - 用户操作手册（初稿）

3. **测试交付**
   - 单元测试报告（覆盖率≥80%）
   - 集成测试报告
   - 安全测试报告

## 六、验收标准
1. 功能完成度：100%覆盖需求文档中的功能点
2. 界面一致性：符合UI设计规范，响应式布局适配
3. 性能指标：接口响应时间≤300ms，无内存泄漏
4. 安全审计：通过基础安全测试，无高危漏洞
5. 文档完整性：交付所有规定文档，内容准确无误

## 七、依赖与约束
1. 依赖PostgreSQL数据库环境正常运行
2. 前端构建依赖Node.js 16+环境
3. 需提前准备服务器SSL证书（HTTPS支持）
4. 开发环境需配置Git版本控制

## 八、附录
### 8.1 术语定义
- **RBAC**：基于角色的访问控制
- **JWT**：JSON Web Token，用于身份验证的令牌
- **功能权限**：控制用户可访问的功能模块和操作

### 8.2 参考文档
- 《产品设计文档》（product_design.md）
- 《开发策略计划》（development_plan.md）
- 《ASP.NET Core安全最佳实践》